@me Error: Failed to launch the browser process! undefined TROUBLESHOOTING: https://pptr.dev/troubleshooting

ERROR: exportPdf()

@me 自宅ではエラーが出ません。会社でエラーが出ます。crowdstrike, skysea, がchrome.exe の起動を阻止していますか？

@ai はい、CrowdStrikeやSKYSEA Client Viewなどのエンドポイントセキュリティ（EDR/IT資産管理）ソフトウェアは、会社のPCでchrome.exeなどの外部プロセスの起動を制限・ブロックすることがあります。

Puppeteerは内部でChrome（またはEdge）を起動するため、これらのセキュリティ製品が「不審な自動ブラウザ起動」とみなして遮断するケースが多いです。

## 【よくある対策】

- 管理者に「PuppeteerでChrome/Edgeを自動起動したい」と申請し、例外設定（ホワイトリスト）を依頼する
- 会社PCではPuppeteerの機能を使わず、手動で画像化・PDF化する運用に切り替える
- Edge（msedge.exe）も同様にブロックされる場合が多いです

## 【確認方法】

- CrowdStrikeやSKYSEAの管理画面で「chrome.exeの起動ブロック履歴」が記録されているか確認
- PuppeteerのexecutablePathをchrome.exe以外（例：社内で許可されたブラウザ）にしても同様のエラーが出るかテスト

## 【補足】

自宅PCで問題なく動作するのは、これらのセキュリティ制限がないためです
会社PCのセキュリティポリシーは管理者権限がないと変更できません
ご参考までに、会社PCでの自動ブラウザ起動は多くの企業で制限されています。
もし社内で例外申請が難しい場合は、Puppeteerを使ったエクスポート機能は利用できません。
